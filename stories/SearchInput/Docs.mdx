import { Canvas, Meta } from '@storybook/blocks'

import * as SearchInputStories from './SearchInput.stories'

<Meta of={SearchInputStories} />

# Search Input

A search is a user interface element that includes a search bar or input field, often accompanied by a search button or icon. It enables users to enter keywords or queries and initiate a search for specific content or information within an application or website. The search component helps users quickly find relevant data or resources by matching their input with the available content.

<Canvas of={SearchInputStories.Default} />

The attributes for the Search Input are identical to that of the `<HTMLInputElement>` type, with the addition of `buttonOnClick`, which allows the user to control how the clear button should work. By default it does nothing.

When accessing the focused state of the Search Input, users should use the `peer` class on the `<SearchInput>` component, and then use `peer-focus-within:visible`, as shown in the example below.

## SearchInput

```tsx
import React from 'react'
import SearchOutline from '@/assets/build/search-outline.icon'
import ClearIcon from '@/assets/build/x-outline.icon'
import { cn } from '@/lib/utils'
import { cva } from 'class-variance-authority'

const searchVariants = cva([
  [
    'flex',
    'border border-[1px]',
    'border-border-subtle',
    'rounded-lg',
    'overflow-hidden',
    'p-3',
    'gap-[6px]',
    'focus-within:border-border-focus',
    'hover:border-border-hover',
    'focus-within:hover:border-border-focus',
    'bg-background-alt',
    'dark:text-foreground-muted-dark',
    'dark:border-border-subtle-dark',
    'dark:bg-background-alt-dark',
    'dark:hover:border-border-hover-dark',
    'dark:focus-within:border-border-focus-dark',
    'dark:focus-within:hover:border-border-focus-dark'
  ],
  [
    '[&>*]:bg-transparent',
    '[&>input:focus]:outline-none',
    '[&>input]:self-stretch',
    '[&>input]:items-center',
    '[&>input]:flex',
    '[&>input]:flex-grow'
  ],
  ['[&>button]:ml-6']
])

interface SearchInputProps extends React.HTMLProps<HTMLInputElement> {
  buttonOnClick?: () => void
}

const SearchInput = React.forwardRef<HTMLInputElement, SearchInputProps>(
  ({ className, buttonOnClick, ...props }, ref) => {
    return (
      <div className={cn(searchVariants(), className)}>
        <span>
          <SearchOutline />
        </span>
        <input required type="text" ref={ref} {...props} className="peer" />
        <button onClick={buttonOnClick} className="peer-invalid:invisible">
          <ClearIcon />
        </button>
      </div>
    )
  }
)

export { SearchInput, SearchInputProps }
```

## Example

<Canvas of={SearchInputStories.Example} />

```tsx
import { useState, useRef } from 'react'
import { SearchInput } from '@/index'
export const SearchInputDemo = () => {
  const [value, setValue] = useState('')
  const focused = useRef<HTMLInputElement>(null)
  const dropdownList = [
    'About',
    'Base',
    'Blog',
    'Contact',
    'Custom',
    'Support',
    'Tools'
  ]

  const clearText = () => {
    setValue('')
    if (focused.current) {
      focused.current.focus()
    }
  }

  const dropdownTags = dropdownList.map(item => {
    if (!value || value.length === 0) {
      return (
        <a
          key={item}
          onClick={() => {
            setValue(item)
          }}
          href={`#${item.toLowerCase()}`}
        >
          {item}
        </a>
      )
    }
    const valueRegex = new RegExp(`${value}`, 'i')
    if (valueRegex.test(item)) {
      return (
        <a key={item} href={`#${item.toLowerCase()}`}>
          {item}
        </a>
      )
    }
  })
  const onValueChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setValue(e.target.value)
  }

  return (
    <div className="flex flex-col space-y-1">
      <SearchInput
        value={value}
        buttonOnClick={clearText}
        onChange={onValueChange}
        className="peer"
        ref={focused}
      />

      <div className="z-2 bg-background-alt p-1 border border-border [&>a:hover]:bg-background-subtle hidden peer-focus-within:flex peer-focus-within:flex-col hover:flex hover:flex-col">
        {dropdownTags}
      </div>
    </div>
  )
}
```
